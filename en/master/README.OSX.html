

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Building Hercules for OSX &mdash; Hercules Documentation Demo 1.0.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link href="_static/herc_style.css" rel="stylesheet" type="text/css">

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Hercules Documentation Demo
          

          
          </a>

          
            
            
              <div class="version">
                master
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="hercinst.html">Building and Installing</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Configuration File</a></li>
<li class="toctree-l1"><a class="reference internal" href="hercdasd.html">Creating DASD</a></li>
<li class="toctree-l1"><a class="reference internal" href="hercoper.html">Operating Procedure</a></li>
<li class="toctree-l1"><a class="reference internal" href="hercsupp.html">Technical Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="hercfaq.html">Frequently-Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="messages.html">Messages and Codes</a></li>
<li class="toctree-l1"><a class="reference internal" href="aa_auxdocs.html">Supporting documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="appendix_a.html">Appendix A - Documentation Standards</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Hercules Documentation Demo</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Building Hercules for OSX</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/README.OSX.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="building-hercules-for-osx">
<h1>Building Hercules for OSX<a class="headerlink" href="#building-hercules-for-osx" title="Permalink to this heading">¶</a></h1>
<p>To compile on OS X for another architecture than the one running, or
another OS version, you have to supply several arguments to the
configure command.</p>
<p>To force a particular architecture, you need to specify the machine
architecture to the gcc command with the <code class="docutils literal notranslate"><span class="pre">-arch</span> <span class="pre">&lt;architecture&gt;</span></code>
operand. You also need to tell configure what environment you’re
building for, with <code class="docutils literal notranslate"><span class="pre">--host</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ARCHITECTURE</span>    <span class="o">-</span><span class="n">arch</span>   <span class="o">--</span><span class="n">host</span>
<span class="mi">32</span><span class="o">-</span><span class="n">bit</span> <span class="n">Intel</span>    <span class="n">i386</span>    <span class="n">i686</span>
<span class="mi">64</span><span class="o">-</span><span class="n">bit</span> <span class="n">Intel</span>    <span class="n">x86_64</span>  <span class="n">x86_64</span>
<span class="mi">32</span><span class="o">-</span><span class="n">bit</span> <span class="n">PowerPC</span>  <span class="n">ppc</span>     <span class="n">powerpc</span>
<span class="mi">64</span><span class="o">-</span><span class="n">bit</span> <span class="n">PowerPC</span>  <span class="n">ppc64</span>   <span class="n">powerpc64</span>
</pre></div>
</div>
<p>The argument for <code class="docutils literal notranslate"><span class="pre">--host</span></code> is the first part of a build triplet,
specified as –. The vendor is apple for all OS X builds. OS is
“darwin8.8.0” for OS X 10.4 (Tiger), and “darwin9.6.0” for OS X 10.5
(Leopard). This makes, for example, building for 64-bit Intel on Leopard
use <code class="docutils literal notranslate"><span class="pre">--host</span> <span class="pre">x86_64-apple-darwin9.6.0</span></code>. The -arch argument is specified
by overriding the CC (C compiler) value and adding it to the end, as in
<code class="docutils literal notranslate"><span class="pre">CC=&quot;gcc-arch</span> <span class="pre">x86_64&quot;</span></code>.</p>
<p>If you’re building for an OS that’s not the one you’re running on, you
also need to tell the build environment that you’re doing so. For
building for Tiger on Leopard, you need to add two arguments to the
configure invocation:
<code class="docutils literal notranslate"><span class="pre">CFLAGS='-isysroot/Developer/SDKs/MacOSX10.4u.sdk'</span> <span class="pre">LDFLAGS='-isysroot/Developer/SDKs/MacOSX10.4u.sdk</span> <span class="pre">-Wl,-syslibroot,/Developer/SDKs/MacOSX10.4u.sdk'</span></code>
(all on one line, of course). You also need to add an environment
variable that’s passed to gcc upon invocation, and this takes adding it
to the beginning of the CC value, as in
<code class="docutils literal notranslate"><span class="pre">CC=&quot;/usr/bin/env</span> <span class="pre">MACOSX_DEPLOYMENT_TARGET=10.4</span> <span class="pre">gcc</span> <span class="pre">-arch</span> <span class="pre">ix86_64</span></code>.</p>
<p>This makes a complete invocation for building for 32-bit Intel for Tiger
on Leopard (again, all on one line):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CC</span><span class="o">=</span><span class="s2">&quot;/usr/bin/env MACOSX_DEPLOYMENT_TARGET=10.4 gcc -arch i386&quot;</span> <span class="n">CFLAGS</span><span class="o">=</span><span class="s1">&#39;-isysroot /Developer/SDKs/MacOSX10.4u.sdk&#39;</span> <span class="n">LDFLAGS</span><span class="o">=</span><span class="s1">&#39;-isysroot /Developer/SDKs/MacOSX10.4u.sdk -Wl,-syslibroot,/Developer/SDKs/MacOSX10.4u.sdk&#39;</span> <span class="o">./</span><span class="n">configure</span> <span class="o">--</span><span class="n">enable</span><span class="o">-</span><span class="n">setuid</span><span class="o">-</span><span class="n">hercifc</span> <span class="o">--</span><span class="n">host</span><span class="o">=</span><span class="n">i686</span><span class="o">-</span><span class="n">apple</span><span class="o">-</span><span class="n">darwin8</span><span class="mf">.8.0</span>
</pre></div>
</div>
<p>Building 32-bit Intel for Leopard on Leopard is easier:</p>
<p><code class="docutils literal notranslate"><span class="pre">CC=&quot;gcc</span> <span class="pre">-arch</span> <span class="pre">i386&quot;</span> <span class="pre">./configure</span> <span class="pre">--enable-setuid-hercifc</span> <span class="pre">--host=i686-apple-darwin9.6.0</span></code></p>
<p>(Note that building a 64-bit Intel version on a Mac with a 64-bit Intel
processor still requires explicitly setting the architecture. If you
don’t, you’ll get a 32-bit Intel version.)</p>
<p>Once you have the various architectures built, you can combine them into
one binary with lipo. This is done by saying
<code class="docutils literal notranslate"><span class="pre">lipo</span> <span class="pre">&lt;input-files&gt;</span> <span class="pre">-output</span> <span class="pre">&lt;output-file&gt;</span> <span class="pre">-create</span></code>. The best approach
is to automate this with a shell script; I’ve done this for my own use.</p>
<section id="tun-tap-information">
<h2>Tun Tap Information<a class="headerlink" href="#tun-tap-information" title="Permalink to this heading">¶</a></h2>
<p>From: <a class="reference external" href="http://tech.groups.yahoo.com/group/hercules-390/message/61064">http://tech.groups.yahoo.com/group/hercules-390/message/61064</a></p>
<p>First, the CTC definition should be set up as follows:</p>
<p><code class="docutils literal notranslate"><span class="pre">0400.2</span> <span class="pre">3088</span> <span class="pre">CTCI</span> <span class="pre">/dev/tun0</span> <span class="pre">1500</span> <span class="pre">192.168.0.12</span> <span class="pre">192.168.0.103</span> <span class="pre">255.255.255.255</span></code></p>
<p>Unlike Linux, you don’t use two consecutive IP addresses on the CTCI
definition. You use the <em>host</em> IP address (the address that Hercules
will use) followed by the IP address of the computer that will be
hosting Hercules. Note the subnet mask. The whole IP address is the
network ID.</p>
<p>Next, IP forwarding needs to be enabled. I wrote a shell script with the
command to do the job and have it run when I boot the Mac. The command
to enable IP forwarding on the Mac is:</p>
<p><code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">sysctl</span> <span class="pre">-w</span> <span class="pre">net.inet.IP.forwarding=1</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">sudo</span></code> switches you to root; sysctl with the <code class="docutils literal notranslate"><span class="pre">-w</span></code> switch means to
“write the value” or “set the value” of the variable
<code class="docutils literal notranslate"><span class="pre">net.inet.IP.forwarding</span></code> to 1. This is similar to Linux, except there
you use an echo command to set a variable that applies to setting an IP
forwarding to 1.</p>
<p>Before doing the above, though, you must assign the root user a password
as follows:</p>
<p><code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">passwd</span> <span class="pre">root</span></code></p>
<p>passwd is a variable and can be substituted with any password you like.
You will need to assign a password to root because the previous command
will prompt you for a password for root access to change the variable
net.inet.IP.forwarding from the default “0” to “1”.</p>
<p>Proxy Arp is already set <code class="docutils literal notranslate"><span class="pre">ON</span></code> in a Mac. This is what really confused
me. I kept reading <em>everywhere</em> in Google that it is set <code class="docutils literal notranslate"><span class="pre">ON</span></code> by
default. Then I stumbled on the magic command that ties your Hercules
host IP address to your ethernet interface so that computers behind the
router can get to it and so that Hercules can get out to the rest of the
world (the internet). It is the ARP command. It needs be be coded like
this:</p>
<p><code class="docutils literal notranslate"><span class="pre">arp</span> <span class="pre">-s</span> <span class="pre">192.168.0.12</span> <span class="pre">00:16:cb:aa:d4:4c</span> <span class="pre">pub</span> <span class="pre">en0</span></code></p>
<p>The above command “ties” the host IP address of your Hercules machine(in
this case 192.168.0.12) to the interface <code class="docutils literal notranslate"><span class="pre">en0</span></code> (which happens to be my
ethernet card) allowing access to and from the Hercules machine from
behind the router and out to the internet.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">-s</span></code> switch tells the arp command you will be specifying a host
and a ether address (the MAC address of your ethernet card,
e.g. <code class="docutils literal notranslate"><span class="pre">00:16:cb:aa:d4:4c</span></code> in my case).</p>
<p>If the word <code class="docutils literal notranslate"><span class="pre">pub</span></code> is given, the entry will be “published”, i.e. this
system will act as an ARP server. This is the “magic” that is needed to
communicate to and from the Hercules host outside of the computer it is
running on. It is equivalent to setting <code class="docutils literal notranslate"><span class="pre">proxy_arp</span></code> to ‘1’ on Linux,
but not exactly as proxy arp is always <code class="docutils literal notranslate"><span class="pre">ON</span></code> in a OSX environment.
Rather, it just “clarifies” what host and interface you want to use with
proxy arp.</p>
<p><code class="docutils literal notranslate"><span class="pre">en0</span></code> is the name of the interface (the ethernet card).</p>
<p>The rest of IP setup is the same as any other system you will be running
on (Linux, Windows, etc.) and all applies to parameters that must be set
on the mainframe operating system you are using (all this is documented
in the Hercules TCP/IP documentation).</p>
<p>Since none of the above is documented, I wanted to document it here for
everyone to see, should they want to run Hercules on a Mac (and the Unix
terminal system) it runs on.</p>
<p>It’s incredible how <em>fast</em> my mainframe is running on such a small box.
Incredible. I find Hercules runs better on a Mac than on any other
platform. Linux works well, but a Mac is much more usable in other ways
than Linux is (for other things).</p>
<p>Well, thank you all for your patience. I sit up all night trying to
figure this stuff out because I can’t sleep, and I want to share what I
have found as many of you have helped me (especially in the early days)
when I was learning how to use Hercules.</p>
</section>
</section>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2023

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> Read the Docs</span>
      v: master
      <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      
      <dl>
        <dt>Languages</dt>
        
           <strong> 
          <dd><a href="/herc-docs-demo/en/master/">en</a></dd>
           </strong> 
        
      </dl>
      
      
      <dl>
        <dt>Versions</dt>
        
          
          <dd><a href="/herc-docs-demo/en/fovea1959/">fovea1959</a></dd>
          
        
           <strong> 
          <dd><a href="/herc-docs-demo/en/master/">master</a></dd>
           </strong> 
        
          
          <dd><a href="/herc-docs-demo/en/0.0/">0.0</a></dd>
          
        
          
          <dd><a href="/herc-docs-demo/en/1.0/">1.0</a></dd>
          
        
      </dl>
      
      
      <dl>
        <dt>Downloads</dt>
        
          <dd><a href="/herc-docs-demo/en/master/Hercules Documentation Demo-docs_en_master.pdf">pdf</a></dd>
        
          <dd><a href="/herc-docs-demo/en/master/Hercules Documentation Demo-docs_en_master.epub">epub</a></dd>
        
          <dd><a href="/herc-docs-demo/en/master/Hercules Documentation Demo-docs_en_master.html.tar.gz">tarred HTML</a></dd>
        
          <dd><a href="/herc-docs-demo/en/master/Hercules Documentation Demo-docs_en_master.single.html.tar.gz">tarred single file HTML</a></dd>
        
      </dl>
      
      
      <hr/>
      <a href="https://tech.michaelaltfield.net/2020/07/18/sphinx-rtd-github-pages-1/">Continuous Documentation</a> hosting provided by <a href="https://pages.github.com/">GitHub Pages</a>.
 
    </div>
  </div>

 

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>