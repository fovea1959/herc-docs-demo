

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Host Resource Access Facility &mdash; Hercules Documentation Demo 1.0.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link href="_static/herc_style.css" rel="stylesheet" type="text/css">

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Hercules Documentation Demo
          

          
          </a>

          
            
            
              <div class="version">
                master
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="hercinst.html">Building and Installing</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Configuration File</a></li>
<li class="toctree-l1"><a class="reference internal" href="hercdasd.html">Creating DASD</a></li>
<li class="toctree-l1"><a class="reference internal" href="hercoper.html">Operating Procedure</a></li>
<li class="toctree-l1"><a class="reference internal" href="hercsupp.html">Technical Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="hercfaq.html">Frequently-Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="messages.html">Messages and Codes</a></li>
<li class="toctree-l1"><a class="reference internal" href="aa_auxdocs.html">Supporting documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="appendix_a.html">Appendix A - Documentation Standards</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Hercules Documentation Demo</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Host Resource Access Facility</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/README.HRAF.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="host-resource-access-facility">
<h1>Host Resource Access Facility<a class="headerlink" href="#host-resource-access-facility" title="Permalink to this heading">¶</a></h1>
<p>The Host Resource Access Facility (HRAF) provides direct access to host
resources by a Hercules guest program operating in privileged operation
state via a Hercules supplied DIAGNOSE code X’F18’.</p>
<p>DIAGNOSE X’F18’ utilizes a set of subcodes for selection of the type of
resource and the mechanism in use by the program. Additionally, a
subcode allows the DIAGNOSE X’F18’ functionality to be queried for the
capabilitites provided. As the functionality is enhanced over time, the
query subcode will report a new version number.</p>
<section id="general-register-usage">
<h2>General Register Usage<a class="headerlink" href="#general-register-usage" title="Permalink to this heading">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DIAGNOSE</span>  <span class="n">Rx</span><span class="p">,</span><span class="n">Ry</span><span class="p">,</span><span class="n">X</span><span class="s1">&#39;F18&#39;</span>
</pre></div>
</div>
<p>The first operand of the DIAGNOSE, Rx, must be an even-odd pair of
registers. The second operand, Ry, may be any register. The contents of
the registers are:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Register</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Rx</p></td>
<td><p>Contains the subcode, a 32-bit unsigned value.</p></td>
</tr>
<tr class="row-odd"><td><p>Rx+1</p></td>
<td><p>Contains the operational options used by the DIAGNOSE,
if required by the subcode</p></td>
</tr>
<tr class="row-even"><td><p>Ry</p></td>
<td><p>Contains the real address of the subcode’s parameter
block. All subcodes require a parameter block.</p></td>
</tr>
</tbody>
</table>
<p>Two mechanisms are provided for accessing host resources:
<strong>compatibility mode</strong> and <strong>native mode</strong>. The primary difference
between the two modes is the structure and size of the parameter block
associated with the host resource being accessed.</p>
<p><em>Compatibility mode</em> is intended to ease the migration from the original
Jason Winter general instructions to the privileged DIAGNOSE code. The
compatibility parameter block is essentially a 32-bit register save area
corresponding to the values that would have been encountered had the
Jason Winter general instruction been used.</p>
<p>The <em>native mode</em> parameter block will use a different format allowing
functional extensions and compatibility mode limitations to be
eliminated.</p>
</section>
<section id="enabling-the-host-resouce-access-facility">
<h2>Enabling the Host Resouce Access Facility<a class="headerlink" href="#enabling-the-host-resouce-access-facility" title="Permalink to this heading">¶</a></h2>
<p>By default, the Host Resource Access Facility is disabled. Use the
<code class="docutils literal notranslate"><span class="pre">archlvl</span></code> command to enable the facility:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">archlvl</span>   <span class="n">enable</span>  <span class="n">HERC_HOST_RESOURCE_ACCESS</span>
</pre></div>
</div>
</section>
<section id="diagnose-xf18-subcodes">
<h2>DIAGNOSE X’F18’ Subcodes<a class="headerlink" href="#diagnose-xf18-subcodes" title="Permalink to this heading">¶</a></h2>
<p>The following subcodes are supported or planned. The DIAGNOSE version in
which the subcode has been made available is identified. A ‘-’ indicates
a future planned subcode.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Subcode</p></th>
<th class="head"><p>Version</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>X’00
000000’</p></td>
<td><p>1</p></td>
<td><p>Query DIAGNOSE X’F18’ available
functionality</p></td>
</tr>
<tr class="row-odd"><td><p>X’00
000001’</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
<td><p>Perform a compatibility mode host socket
function</p></td>
</tr>
<tr class="row-even"><td><p>X’00
000002’</p></td>
<td><p>1</p></td>
<td><p>Perform a compatibility mode host file
system operation</p></td>
</tr>
<tr class="row-odd"><td><p>X’00
000003’</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
<td><p>Perform a native mode host socket function</p></td>
</tr>
<tr class="row-even"><td><p>X’00
000004’</p></td>
<td><ul class="simple">
<li></li>
</ul>
</td>
<td><p>Perform a native mode host file system
operation</p></td>
</tr>
</tbody>
</table>
<section id="subcode-x00000000-query-diagnose-xf18">
<h3>Subcode X’00000000’ - Query DIAGNOSE X’F18’<a class="headerlink" href="#subcode-x00000000-query-diagnose-xf18" title="Permalink to this heading">¶</a></h3>
<p>The query subcode provides the following information in its response
parameter block:</p>
<ul class="simple">
<li><p>The version of DIAGNOSE X’F18’ provided by the executing Hercules
emulator</p></li>
<li><p>Available facilities and modes of operation</p></li>
<li><p>Whether large file system support is available</p></li>
<li><p>The host platform to which resource access is being provided</p></li>
<li><p>Addressing modes supported</p></li>
<li><p>Additional information specific to subcodes.</p></li>
</ul>
</section>
<section id="subcode-x00000001-compatibility-mode-tcp-socket-access">
<h3>Subcode X’00000001’ - Compatibility Mode TCP Socket Access<a class="headerlink" href="#subcode-x00000001-compatibility-mode-tcp-socket-access" title="Permalink to this heading">¶</a></h3>
<p>Planned for future implementation, incorporates functionality comparable
to that offered by the <code class="docutils literal notranslate"><span class="pre">dyn75</span></code> package Hercules module.</p>
</section>
<section id="subcode-x00000002-compatibility-mode-file-system-access">
<h3>Subcode X’00000002’ - Compatibility Mode File System Access<a class="headerlink" href="#subcode-x00000002-compatibility-mode-file-system-access" title="Permalink to this heading">¶</a></h3>
<p>The following operations are provided, as identified by the operation
field of the parameter block:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Operation</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>Rename a file</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>Unlink the file (delete)</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>Open a file</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>Close a file based upon it’s name</p></td>
</tr>
<tr class="row-even"><td><p>4</p></td>
<td><p>Read from a file in either binary or text modes</p></td>
</tr>
<tr class="row-odd"><td><p>5</p></td>
<td><p>Write to a file in either binary or text modes</p></td>
</tr>
<tr class="row-even"><td><p>6</p></td>
<td><p>Seek to a position in a file</p></td>
</tr>
<tr class="row-odd"><td><p>7</p></td>
<td><p>Commit any pending writes to the file</p></td>
</tr>
<tr class="row-even"><td><p>8</p></td>
<td><p>Close a file using its file handle</p></td>
</tr>
<tr class="row-odd"><td><p>9</p></td>
<td><p>Set the file read/write mode to binary or text</p></td>
</tr>
</tbody>
</table>
</section>
<section id="subcode-x00000002-limitations">
<h3>Subcode X’00000002’ - Limitations<a class="headerlink" href="#subcode-x00000002-limitations" title="Permalink to this heading">¶</a></h3>
<p>Compatibility mode access to the host file system is restricted in the
following ways:</p>
<ul class="simple">
<li><p>Large file system support is not available.</p></li>
<li><p>Use of subcode X’00000002’ in z/Architecture mode requires the
current PSW addressing mode to be set to either 24- or 31-bit before
execution of DIAGNOSE X’F18’, otherwise a specification exception
occurs.</p></li>
<li><p>Dynamic Address Translation using secondary space, home space or
access register modes are not available. Only DAT-off and DAT-on
primary-space modes are supported, as specified in the operation
options parameter in the odd register of the pair.</p></li>
</ul>
</section>
<section id="subcode-x00000003-native-mode-tcp-socket-access">
<h3>Subcode X’00000003’ - Native Mode TCP Socket Access<a class="headerlink" href="#subcode-x00000003-native-mode-tcp-socket-access" title="Permalink to this heading">¶</a></h3>
<p>While eliminating limitations that may exist in the compatibility mode
TCP socket access, the native mode subcode is expected to implement IPv6
capability as well as IPv4. This subcode is planned for future
implementation.</p>
</section>
<section id="subcode-x00000004-native-mode-file-system-access">
<h3>Subcode X’00000004’ - Native Mode File System Access<a class="headerlink" href="#subcode-x00000004-native-mode-file-system-access" title="Permalink to this heading">¶</a></h3>
<p>Primarily intended to eliminate some or all of the restrictions
identified above for the compatibility mode subcode.</p>
</section>
</section>
<section id="documentation">
<h2>Documentation<a class="headerlink" href="#documentation" title="Permalink to this heading">¶</a></h2>
<p>This file is intended to provide general information about the Host
Resource Access Facility and is not intended to provide detaled
information about DIAGNOSE X’F18’. Until this documentation is made
available by the Hercules project, contact the author on the main
Hercules email list for access.</p>
</section>
<section id="giving-credit-where-credit-is-due">
<h2>Giving credit where credit is due<a class="headerlink" href="#giving-credit-where-credit-is-due" title="Permalink to this heading">¶</a></h2>
<p>Jason Winter developed the original support providing users access to
host facilities. This support for many years has been provided as
externally loaded functionality into Hercules as two different packages:
<code class="docutils literal notranslate"><span class="pre">dyn76</span></code>, for access to the host file system, and <code class="docutils literal notranslate"><span class="pre">dyn75</span></code>, for access
to host TCP sockets.</p>
<p>The compatibility functionality offered by the Host Resource Access
Facility is based upon Jason Winter’s original code, the licensing to
which has been generously provided by Jason to the Hercules community.
See file <code class="docutils literal notranslate"><span class="pre">`license_dyn76.txt</span></code> &lt;../license_dyn76.txt&gt;`__ for the
licensing of the Hercules host file system functionality provided by the
<code class="docutils literal notranslate"><span class="pre">dyn76</span></code> package. Currently, Hercules has only incorporated the
<code class="docutils literal notranslate"><span class="pre">dyn76</span></code> Hercules functionality. <code class="docutils literal notranslate"><span class="pre">dyn75</span></code> is planned for future
Hercules incorporation. Thank you, Jason Winter.</p>
<div class="line-block">
<div class="line">– Harold Grovesteen</div>
<div class="line">Apr 23, 2011</div>
</div>
</section>
</section>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2023

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> Read the Docs</span>
      v: master
      <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      
      <dl>
        <dt>Languages</dt>
        
           <strong> 
          <dd><a href="/herc-docs-demo/en/master/">en</a></dd>
           </strong> 
        
      </dl>
      
      
      <dl>
        <dt>Versions</dt>
        
          
          <dd><a href="/herc-docs-demo/en/fovea1959/">fovea1959</a></dd>
          
        
           <strong> 
          <dd><a href="/herc-docs-demo/en/master/">master</a></dd>
           </strong> 
        
          
          <dd><a href="/herc-docs-demo/en/0.0/">0.0</a></dd>
          
        
          
          <dd><a href="/herc-docs-demo/en/1.0/">1.0</a></dd>
          
        
      </dl>
      
      
      <dl>
        <dt>Downloads</dt>
        
          <dd><a href="/herc-docs-demo/en/master/Hercules Documentation Demo-docs_en_master.pdf">pdf</a></dd>
        
          <dd><a href="/herc-docs-demo/en/master/Hercules Documentation Demo-docs_en_master.epub">epub</a></dd>
        
          <dd><a href="/herc-docs-demo/en/master/Hercules Documentation Demo-docs_en_master.html.tar.gz">tarred HTML</a></dd>
        
          <dd><a href="/herc-docs-demo/en/master/Hercules Documentation Demo-docs_en_master.single.html.tar.gz">tarred single file HTML</a></dd>
        
      </dl>
      
      
      <hr/>
      <a href="https://tech.michaelaltfield.net/2020/07/18/sphinx-rtd-github-pages-1/">Continuous Documentation</a> hosting provided by <a href="https://pages.github.com/">GitHub Pages</a>.
 
    </div>
  </div>

 

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>